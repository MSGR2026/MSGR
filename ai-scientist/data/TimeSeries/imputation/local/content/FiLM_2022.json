{
  "id": "FiLM_2022",
  "paper_title": "FiLM: Frequency improved Legendre Memory Model for Long-term Time Series Forecasting",
  "alias": "FiLM",
  "year": 2022,
  "domain": "TimeSeries",
  "task": "anomaly_detection",
  "idea": "FiLM (Feature-wise Linear Modulation) applies learned affine transformations (γ and β parameters) to intermediate CNN features based on linguistic input, enabling adaptive visual reasoning without explicit architectural modularity. The method conditions visual processing through feature-wise scaling and shifting operations that can selectively activate, suppress, or shut off feature maps based on questions, achieving implicit spatial and functional modularity through end-to-end learning rather than hard-coded reasoning structures.",
  "introduction": "# 1 Introduction\n\nThe ability to reason about everyday visual input is a fundamental building block of human intelligence. Some have argued that for artificial agents to learn this complex, structured process, it is necessary to build in aspects of reasoning, such as compositionality (Hu et al. 2017; Johnson et al. 2017b) or relational computation (Santoro et al. 2017). However, if a model made from general-purpose components could learn to visually reason, such an architecture would likely be more widely applicable across domains.\n\nTo understand if such a general-purpose architecture exists, we take advantage of the recently proposed CLEVR dataset (Johnson et al. 2017a) that tests visual reasoning via question answering. Examples from CLEVR are shown in Figure 1. Visual question answering, the general task of asking questions about images, has its own line of datasets (Malinowski and Fritz 2014; Geman et al. 2015; Antol et al. 2015) which generally focus on asking a diverse set of simpler questions on images, often answerable in a single glance. From these datasets, a number of effective, general-purpose deep learning models have emerged for visual question answering (Malinowski, Rohrbach, and Fritz 2015; Yang et al. 2016; Lu et al. 2016; Anderson et al. 2017). However, tests on CLEVR show that these general deep learning approaches struggle to learn structured, multi-step reasoning (Johnson et al. 2017a). In particular, these methods tend\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-14/88b3b409-62e9-4654-98b2-6f9cd3da03d9/0a873b47ebbc280ff7d341eff03f8c5686fab716c19e9d95ce0a29e669940203.jpg)  \n(a) Q: What number of cylinders are small purple things or yellow rubber things? A: 2\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-14/88b3b409-62e9-4654-98b2-6f9cd3da03d9/453310f23a2f86ceb077552792369ad0e188525b2ef8b57d358ed8868d48df4f.jpg)  \n(b) Q: What color is the other object that is the same shape as the large brown matte thing? A: Brown  \nFigure 1: CLEVR examples and FiLM model answers.\n\nto exploit biases in the data rather than capture complex underlying structure behind reasoning (Goyal et al. 2017).\n\nIn this work, we show that a general model architecture can achieve strong visual reasoning with a method we introduce as FiLM: Feature-wise Linear Modulation. A FiLM layer carries out a simple, feature-wise affine transformation on a neural network's intermediate features, conditioned on an arbitrary input. In the case of visual reasoning, FiLM layers enable a Recurrent Neural Network (RNN) over an input question to influence Convolutional Neural Network (CNN) computation over an image. This process adaptively and radically alters the CNN's behavior as a function of the input question, allowing the overall model to carry out a variety of reasoning tasks, ranging from counting to comparing, for example. FiLM can be thought of as a generalization of Conditional Normalization, which has proven highly successful for image stylization (Dumoulin, Shlens, and Kudlur 2017; Ghiasi et al. 2017; Huang and Belongie 2017), speech recognition (Kim, Song, and Bengio 2017), and visual question answering (de Vries et al. 2017), demonstrating FiLM's broad applicability.\n\nIn this paper, which expands upon a shorter report (Perez et al. 2017), our key contribution is that we show FiLM is a strong conditioning method by showing the following on visual reasoning tasks:\n\n1. FiLM models achieve state-of-the-art across a variety of visual reasoning tasks, often by significant margins.  \n2. FiLM operates in a coherent manner. It learns a complex, underlying structure and manipulates the conditioned network's features in a selective manner. It also enables the\n\nCNN to properly localize question-referenced objects.\n\n3. FiLM is robust; many FiLM model ablations still outperform prior state-of-the-art. Notably, we find there is no close link between normalization and the success of a conditioned affine transformation, a previously untouched assumption. Thus, we relax the conditions under which this method can be applied.  \n4. FiLM models learn from little data to generalize to more complex and/or substantially different data than seen during training. We also introduce a novel FiLM-based zero-shot generalization method that further improves and validates FiLM's generalization capabilities.\n",
  "method": "# 2 Method\n\nOur model processes the question-image input using FiLM, illustrated in Figure 2. We start by explaining FiLM and then describe our particular model for visual reasoning.\n\n# 2.1 Feature-wise Linear Modulation\n\nFiLM learns to adaptively influence the output of a neural network by applying an affine transformation, or FiLM, to the network's intermediate features, based on some input. More formally, FiLM learns functions  $f$  and  $h$  which output  $\\gamma_{i,c}$  and  $\\beta_{i,c}$  as a function of input  $\\boldsymbol{x}_i$ :\n\n$$\n\\gamma_ {i, c} = f _ {c} \\left(\\boldsymbol {x} _ {i}\\right) \\quad \\beta_ {i, c} = h _ {c} \\left(\\boldsymbol {x} _ {i}\\right), \\tag {1}\n$$\n\nwhere  $\\gamma_{i,c}$  and  $\\beta_{i,c}$  modulate a neural network's activations  $F_{i,c}$ , whose subscripts refer to the  $i^{th}$  input's  $c^{th}$  feature or feature map, via a feature-wise affine transformation:\n\n$$\nF i L M \\left(\\boldsymbol {F} _ {i, c} \\mid \\gamma_ {i, c}, \\beta_ {i, c}\\right) = \\gamma_ {i, c} \\boldsymbol {F} _ {i, c} + \\beta_ {i, c}. \\tag {2}\n$$\n\n$f$  and  $h$  can be arbitrary functions such as neural networks. Modulation of a target neural network's processing can be based on the same input to that neural network or some other input, as in the case of multi-modal or conditional tasks. For CNNs,  $f$  and  $h$  thus modulate the per-feature-map distribution of activations based on  $\\boldsymbol{x}_i$ , agnostic to spatial location.\n\nIn practice, it is easier to refer to  $f$  and  $h$  as a single function that outputs one  $(\\gamma, \\beta)$  vector, since, for example, it is often beneficial to share parameters across  $f$  and  $h$  for more efficient learning. We refer to this single function as the FiLM generator. We also refer to the network to which FiLM layers are applied as the Feature-wise Linearly Modulated network, the FiLM-ed network.\n\nFiLM layers empower the FiLM generator to manipulate feature maps of a target, FiLM-ed network by scaling them up or down, negating them, shutting them off, selectively thresholding them (when followed by a ReLU), and more. Each feature map is conditioned independently, giving the FiLM generator moderately fine-grained control over activations at each FiLM layer.\n\nAs FiLM only requires two parameters per modulated feature map, it is a scalable and computationally efficient conditioning method. In particular, FiLM has a computational cost that does not scale with the image resolution.\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-14/88b3b409-62e9-4654-98b2-6f9cd3da03d9/9eb81c424a8ea4910a461176572ee5370858ba0670a07759a4225fe302232d82.jpg)  \nFigure 2: A single FiLM layer for a CNN. The dot signifies a Hadamard product. Various combinations of  $\\gamma$  and  $\\beta$  can modulate individual feature maps in a variety of ways.\n\n# 2.2 Model\n\nOur FiLM model consists of a FiLM-generating linguistic pipeline and a FiLM-ed visual pipeline as depicted in Figure 3. The FiLM generator processes a question  $x_{i}$  using a Gated Recurrent Unit (GRU) network (Chung et al. 2014) with 4096 hidden units that takes in learned, 200-dimensional word embeddings. The final GRU hidden state is a question embedding, from which the model predicts  $(\\gamma_{i\\cdot}^{n},\\beta_{i\\cdot}^{n})$  for each  $n^{th}$  residual block via affine projection.\n\nThe visual pipeline extracts  $128~14\\times 14$  image feature maps from a resized,  $224\\times 224$  image input using either a CNN trained from scratch or a fixed, pre-trained feature extractor with a learned layer of  $3\\times 3$  convolutions. The CNN trained from scratch consists of 4 layers with  $128~4\\times$  4 kernels each, ReLU activations, and batch normalization, similar to prior work on CLEVR (Santoro et al. 2017). The fixed feature extractor outputs the conv4 layer of a ResNet101 (He et al. 2016) pre-trained on ImageNet (Russakovsky et al. 2015) to match prior work on CLEVR (Johnson et al. 2017a; 2017b). Image features are processed by several - 4 for our model - FiLM-ed residual blocks (ResBlocks) with 128 feature maps and a final classifier. The classifier consists of a  $1\\times 1$  convolution to 512 feature maps, global max-pooling, and a two-layer MLP with 1024 hidden units that outputs a softmax distribution over final answers.\n\nEach FiLM-ed ResBlock starts with a  $1 \\times 1$  convolution followed by one  $3 \\times 3$  convolution with an architecture as depicted in Figure 3. We turn the parameters of batch normalization layers that immediately precede FiLM layers off. Drawing from prior work on CLEVR (Hu et al. 2017; Santoro et al. 2017) and visual reasoning (Watters et al. 2017), we concatenate two coordinate feature maps indicating relative x and y spatial position (scaled from  $-1$  to 1) with the image features, each ResBlock's input, and the classifier's input to facilitate spatial reasoning.\n\nWe train our model end-to-end from scratch with\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-14/88b3b409-62e9-4654-98b2-6f9cd3da03d9/2547db45c0c540f6a4713ea189e62047d5f15ac4c72a16ce3723c5137a243042.jpg)  \nFigure 3: The FiLM generator (left), FiLM-ed network (middle), and residual block architecture (right) of our model.\n\nAdam (Kingma and Ba 2015) (learning rate  $3e^{-4}$ ), weight decay  $(1e^{-5})$ , batch size 64, and batch normalization and ReLU throughout FiLM-ed network. Our model uses only image-question-answer triplets from the training set without data augmentation. We employ early stopping based on validation accuracy, training for 80 epochs maximum. Further model details are in the appendix. Empirically, we found FiLM had a large capacity, so many architectural and hyperparameter choices were for added regularization.\n\nWe stress that our model relies solely on feature-wise affine conditioning to use question information influence the visual pipeline behavior to answer questions. This approach differs from classical visual question answering pipelines which fuse image and language information into a single embedding via element-wise product, concatenation, attention, and/or more advanced methods (Yang et al. 2016; Lu et al. 2016; Anderson et al. 2017).\n",
  "experiments": "# 4 Experiments\n\nFirst, we test our model on visual reasoning with the CLEVR task and use trained FiLM models to analyze what FiLM learns. Second, we explore how well our model generalizes to more challenging questions with the CLEVR-Humans task. Finally, we examine how FiLM performs in few-shot and zero-shot generalization settings using the CLEVR Compositional Generalization Test. In the appendix, we provide an error analysis of our model. Our code is available at https://github.com/ethanjperez/film.\n\n# 4.1 CLEVR Task\n\nCLEVR is a synthetic dataset of 700K (image, question, answer, program) tuples (Johnson et al. 2017a). Images contain 3D-rendered objects of various shapes, materials, colors, and sizes. Questions are multi-step and compositional in nature, as shown in Figure 1. They range from counting questions (\"How many green objects have the same size as the green metallic block?\") to comparison questions (\"Are there fewer tiny yellow cylinders than yellow metal cubes?\") and can be  $40+$  words long. Answers are each one word from a set of 28 possible answers. Programs are an additional supervisory signal consisting of step-by-step instructions, such as filter_shape [cube], relate [right], and count, on how to answer the question.\n\nBaselines We compare against the following methods, discussed in detail in the Related Work section:\n\n- Q-type baseline: Predicts based on a question's category.  \n- LSTM: Predicts using only the question.  \n- CNN+LSTM: MLP prediction over CNN-extracted image features and LSTM-extracted question features.  \n- Stacked Attention Networks (CNN+LSTM+SA): Linear prediction over CNN-extracted image feature and LSTM-extracted question features combined via two rounds of soft spatial attention (Yang et al. 2016).  \n- End-to-End Module Networks (N2NMN) and Program Generator + Execution Engine (PG+EE): Methods in which separate neural networks learn separate subfunctions and are assembled into a question-dependent structure (Hu et al. 2017; Johnson et al. 2017b).  \n- Relation Networks (CNN+LSTM+RN): An approach which builds in pairwise comparisons over spatial locations to explicitly model reasoning's relational nature (Santoro et al. 2017).\n\nResults FiLM achieves a new overall state-of-the-art on CLEVR, as shown in Table 1, outperforming humans and previous methods, including those using explicit models of reasoning, program supervision, and/or data augmentation.\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-14/88b3b409-62e9-4654-98b2-6f9cd3da03d9/2ce70aeefb0f8691d5341d9c2091977e09cb649d3a9847b091f12079b1123426.jpg)  \nQ: What shape is the...  \nQ: How many cyan things are...\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-14/88b3b409-62e9-4654-98b2-6f9cd3da03d9/e04969c7ed9ea3ed5bfb69fe22c6294a396fe0e29429a675ba6530880c5ca1fa.jpg)  \n...purple thing? A: cube  \n...right of the gray cube? A:3\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-14/88b3b409-62e9-4654-98b2-6f9cd3da03d9/6a80192017bdac146a356f7541fb935822e4f2e401f24b07956e8aff1ec450c7.jpg)  \n...blue thing? A: sphere  \n...left of the small cube? A: 2\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-14/88b3b409-62e9-4654-98b2-6f9cd3da03d9/559f74c061669665077092a8ab09f28e82da9407f4badd92012accfacd8103ab.jpg)  \n...red thing right of the blue thing? A: sphere  \n...right of the gray cube and left of the small cube? A: 1\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-14/88b3b409-62e9-4654-98b2-6f9cd3da03d9/14abf4d9a834516bae96e90613ecd42ec46803f12d75bd8c8fbc1338172f7139.jpg)  \n...red thing left of the blue thing? A: cube  \n...right of the gray cube or left of the small cube? A: 4 (P: 3)\n\nFor methods not using extra supervision, FiLM roughly halves state-of-the-art error (from  $4.5\\%$  to  $2.3\\%$ ). Note that using pre-trained image features as input can be viewed as a form of data augmentation in itself but that FiLM performs equally well using raw pixel inputs. Interestingly, the raw pixel model seems to perform better on lower-level questions (i.e. querying and comparing attributes) while the image features model seems to perform better on higher-level questions (i.e. compare numbers of objects).\n\n# 4.2 What Do FiLM Layers Learn?\n\nTo understand how FiLM visually reasons, we visualize activations to observe the net result of FiLM layers. We also use histograms and t-SNE (van der Maaten and Hinton 2008) to find patterns in the learned FiLM  $\\gamma$  and  $\\beta$  parameters themselves. In Figures 14 and 15 in the appendix, we visualize the effect of FiLM at the single feature map level.\n\nActivation Visualizations Figure 4 visualizes the distribution of locations responsible for the globally-pooled features which the MLP in the model's final classifier uses to predict answers. These images reveal that the FiLM model predicts using features of areas near answer-related or question-related objects, as the high CLEVR accuracy also suggests. This finding highlights that appropriate feature modulation indirectly results in spatial modulation, as regions with question-relevant features will have large activations while other regions will not. This observation might explain why FiLM outperforms Stacked Attention, the next best method not explicitly built for reasoning, so significantly (21%); FiLM appears to carry many of spatial attention's benefits, while also influencing feature representation.\n\nFigure 4 also suggests that the FiLM-ed network carries out reasoning throughout its pipeline. In the top example, the FiLM-ed network has localized the answer-referenced object alone before the MLP classifier. In the bottom example, the FiLM-ed network retains, for the MLP classifier, fea\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-14/88b3b409-62e9-4654-98b2-6f9cd3da03d9/8b7cc3f045e0cab97a82e6207acfc073ef811a5ee61054affe1d4b537b3204eb.jpg)  \nFigure 4: Visualizations of the distribution of locations which the model uses for its globally max-pooled features which its final MLP predicts from. FiLM correctly localizes the answer-referenced object (top) or all question-referenced objects (bottom), but not as accurately when it answers incorrectly (rightmost bottom). Questions and images used match (Johnson et al. 2017b).  \nFigure 5: Histograms of  $\\gamma_{i,c}$  (left) and  $\\beta_{i,c}$  (right) values over all FiLM layers, calculated over the validation set.\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-14/88b3b409-62e9-4654-98b2-6f9cd3da03d9/8dda4dfc122077fe45d552e31b10b5294df4649f84a5a545f898b66576a1c635.jpg)\n\ntures on objects that are not referred to by the answer but are referred to by the question. The latter example provides evidence that the final MLP itself carries out some reasoning, using FiLM to extract relevant features for its reasoning.\n\nFiLM Parameter Histograms To analyze at a lower level how FiLM uses the question to condition the visual pipeline, we plot  $\\gamma$  and  $\\beta$  values predicted over the validation set, as shown in Figure 5 and in more detail in the appendix (Figures 16 to 18).  $\\gamma$  and  $\\beta$  values take advantage of a sizable range, varying from -15 to 19 and from -9 to 16, respectively.  $\\gamma$  values show a sharp peak at 0, showing that FiLM learns to use the question to shut off or significantly suppress whole feature maps. Simultaneously, FiLM learns to upregulate a much more selective set of other feature maps with high magnitude  $\\gamma$  values. Furthermore, a large fraction (36%) of  $\\gamma$  values are negative; since our model uses a ReLU after FiLM,  $\\gamma < 0$  can cause a significantly different set of activations to pass the ReLU to downstream layers than  $\\gamma > 0$ . Also,  $76\\%$  of  $\\beta$  values are negative, suggesting that FiLM also uses  $\\beta$  to be selective about which activations pass the ReLU. We show later that FiLM's success is largely architecture-agnostic, but examining a particular model gives insight into the influence FiLM learns to exert\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-14/88b3b409-62e9-4654-98b2-6f9cd3da03d9/8cc395472ac0a5ad0688aca5b97a170d8a3c7c56ea456053f31cc8bef6b3155d.jpg)  \nFigure 6: t-SNE plots of  $(\\gamma, \\beta)$  of the first (left) and last (right) FiLM layers of a 6-FiLM layer Network. FiLM parameters cluster by low-level reasoning functions in the first layer and by high-level reasoning functions in the last layer.\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-14/88b3b409-62e9-4654-98b2-6f9cd3da03d9/52a9a411f7c299a5a7cb6ae0edba59f7adae98da3bb55802abca7689aaaf5c02.jpg)  \n0 - exist  \n1 - less Than  \n2 - greater Than  \n3 - count  \n4 - query_material  \n5 - query_size  \n6 - query_color  \n7 - query_shape  \n8 - equal_color  \n9 - equal_integer  \n10 - equal_shape  \n11 - equal_size  \n12 - equal_material\n\nin a specific case. Together, these findings suggest that FiLM learns to selectively upregulate, downregulate, and shut off feature maps based on conditioning information.\n\nFiLM Parameters t-SNE Plot In Figure 6, we visualize FiLM parameter vectors  $(\\gamma, \\beta)$  for 3,000 random validation points with t-SNE. We analyze the deeper, 6-ResBlock version of our model, which has a similar validation accuracy as our 4-ResBlock model, to better examine how FiLM layers in different layers of a hierarchy behave. First and last layer FiLM  $(\\gamma, \\beta)$  are grouped by the low-level and high-level reasoning functions necessary to answer CLEVR questions, respectively. For example, FiLM parameters for equal_color and query_color are close for the first layer but apart for the last layer. The same is true for shape, size and material questions. Conversely, equal_shape, equal_size, and equal_material FiLM parameters are grouped in the last layer but split in the first layer — likewise for other high level groupings such as integer comparison and querying. These findings suggest that FiLM layers learn a sort of function-based modularity without an architectural prior. Simply with end-to-end training, FiLM learns to handle not only different types of questions differently, but also different types of question sub-parts differently; the FiLM model works from low-level to high-level processes as is the proper approach. For models with fewer FiLM layers, such patterns also appear, but less clearly; these models must begin higher level reasoning sooner.\n\n# 4.3 Ablations\n\nUsing the validation set, we conduct an ablation study on our best model to understand how FiLM learns visual reasoning. We show results for test time ablations in Figure 7, for architectural ablations in Table 2, and for varied model depths in Table 3. Without hyperparameter tuning, most architectural ablations and model depths outperform prior state-of-the-art on training from only image-question-answer triplets, supporting FiLM's overall robustness. Table 3 also shows using the validation set that our results are statistically significant.\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-14/88b3b409-62e9-4654-98b2-6f9cd3da03d9/94505bbde2835e6e59ae0abb8c8c71925d6deead771ef37babd75442bc6cdf06.jpg)  \nFigure 7: An analysis of how robust FiLM parameters are to noise at test time. The horizontal lines correspond to setting  $\\gamma$  or  $\\beta$  to their respective training set mean values.\n\nEffect of  $\\gamma$  and  $\\beta$  To test the effect of  $\\gamma$  and  $\\beta$  separately, we trained one model with a constant  $\\gamma = 1$  and another with  $\\beta = 0$ . With these models, we find a  $1.5\\%$  and  $5\\%$  accuracy drop, respectively; FiLM can learn to condition the CNN for visual reasoning through either biasing or scaling alone, albeit not as well as conditioning both together. This result also suggests that  $\\gamma$  is more important than  $\\beta$ .\n\nTo further compare the importance of  $\\gamma$  and  $\\beta$ , we run a series of test time ablations (Figure 7) on our best, fully-trained model. First, we replace  $\\beta$  with the mean  $\\beta$  across the training set. This ablation in effect removes all conditioning information from  $\\beta$  parameters during test time, from a model trained to use both  $\\gamma$  and  $\\beta$ . Here, we find that accuracy only drops by  $1.0\\%$ , while the same procedure on  $\\gamma$  results in a  $65.4\\%$  drop. This large difference suggests that, in practice, FiLM largely conditions through  $\\gamma$  rather than  $\\beta$ . Next, we analyze performance as we add increasingly more Gaussian noise to the best model's FiLM parameters at test time. Noise in gamma hurts performance significantly more, showing FiLM's higher sensitivity to changes in  $\\gamma$  than in  $\\beta$  and corroborating the relatively greater importance of  $\\gamma$ .\n\nRestricting  $\\gamma$  To understand what aspect of  $\\gamma$  is most effective, we train a model that limits  $\\gamma$  to  $(0,1)$  using sig-\n\n<table><tr><td>Model</td><td>Overall</td></tr><tr><td>Restricted γ or β</td><td></td></tr><tr><td>FiLM with β := 0</td><td>96.9</td></tr><tr><td>FiLM with γ := 1</td><td>95.9</td></tr><tr><td>FiLM with γ := σ(γ)</td><td>95.9</td></tr><tr><td>FiLM with γ := tanh(γ)</td><td>96.3</td></tr><tr><td>FiLM with γ := exp(γ)</td><td>96.3</td></tr><tr><td>Moving FiLM within ResBlock</td><td></td></tr><tr><td>FiLM after residual connection</td><td>96.6</td></tr><tr><td>FiLM after ResBlockReLU-2</td><td>97.7</td></tr><tr><td>FiLM after ResBlockConv-2</td><td>97.1</td></tr><tr><td>FiLM before ResBlockConv-1</td><td>95.0</td></tr><tr><td>Removing FiLM from ResBlocks</td><td></td></tr><tr><td>No FiLM in ResBlock4</td><td>96.8</td></tr><tr><td>No FiLM in ResBlock3-4</td><td>96.5</td></tr><tr><td>No FiLM in ResBlock2-4</td><td>97.3</td></tr><tr><td>No FiLM in ResBlock1-4</td><td>21.4</td></tr><tr><td>Miscellaneous</td><td></td></tr><tr><td>1 × 1 conv only, with no coord. maps</td><td>95.3</td></tr><tr><td>No residual connection</td><td>94.0</td></tr><tr><td>No batch normalization</td><td>93.7</td></tr><tr><td>Replace image features with raw pixels</td><td>97.6</td></tr><tr><td>Best Architecture</td><td>97.4±.4</td></tr></table>\n\nmoid, as many models which use feature-wise, multiplicative gating do. Likewise, we also limit  $\\gamma$  to  $(-1,1)$  using tanh. Both restrictions hurt performance, roughly as much as removing conditioning from  $\\gamma$  entirely by training with  $\\gamma = 1$ . Thus, FiLM's ability to scale features by large magnitudes appears to contribute to its success. Limiting  $\\gamma$  to  $(0,\\infty)$  with  $exp$  also hurts performance, validating the value of FiLM's capacity to negate and zero out feature maps.\n\nConditional Normalization We perform an ablation study on the placement of FiLM to evaluate the relationship between normalization and FiLM that Conditional Normalization approaches assume. Unfortunately, it is difficult to accurately decouple the effect of FiLM from normalization by simply training our corresponding model without normalization, as normalization significantly accelerates, regularizes, and improves neural network learning (Ioffe and Szegedy 2015), but we include these results for completeness. However, we find no substantial performance drop when moving FiLM layers to different parts of our model's ResBlocks; we even reach the upper end of the best model's performance range when placing FiLM after the post-normalization ReLU in the ResBlocks. Thus, we decouple the name from normalization for clarity regarding where the fundamental effectiveness of the method comes from. By demonstrating this conditioning mechanism is not closely connected to normalization, we open the doors to applications other settings in which normalization is less common, such as RNNs and reinforcement learning, which are\n\nTable 2: CLEVR val accuracy for ablations, trained with the best architecture with only specified changes. We report the standard deviation of the best model accuracy over 5 runs.  \n\n<table><tr><td>Model</td><td>Overall</td><td>Model</td><td>Overall</td></tr><tr><td>1 ResBlock</td><td>93.5</td><td>6 ResBlocks</td><td>97.7</td></tr><tr><td>2 ResBlocks</td><td>97.1</td><td>7 ResBlocks</td><td>97.4</td></tr><tr><td>3 ResBlocks</td><td>96.7</td><td>8 ResBlocks</td><td>97.6</td></tr><tr><td>4 ResBlocks</td><td>97.4±.4</td><td>12 ResBlocks</td><td>96.9</td></tr><tr><td>5 ResBlocks</td><td>97.4</td><td></td><td></td></tr></table>\n\nTable 3: CLEVR val accuracy by FiLM model depth.\n\npromising directions for future work with FiLM.\n\nRepetitive Conditioning To understand the contribution of repetitive conditioning towards FiLM model success, we train FiLM models with successively fewer FiLM layers. Models with fewer FiLM layers, even a single FiLM layer, do not deviate far from the best model's performance, revealing that the model can reason and answer diverse questions successfully by modulating features even just once. This observation highlights the capacity of even one FiLM layer. Perhaps one FiLM layer can pass enough question information to the CNN to enable it to carry out reasoning later in the network, in place of the more hierarchical conditioning deeper FiLM models appear to use. We leave more in-depth investigation of this matter for future work.\n\nSpatial Reasoning To examine how FiLM models approach spatial reasoning, we train a version of our best model architecture, from image features, with only  $1 \\times 1$  convolutions and without feeding coordinate feature maps indicating relative spatial position to the model. Due to the global max-pooling near the end of the model, this model cannot transfer information across spatial positions. Notably, this model still achieves a high  $95.3\\%$  accuracy, indicating that FiLM models are able to reason about space simply from the spatial information contained in a single location of fixed image features.\n\nResidual Connection Removing the residual connection causes one of the larger accuracy drops. Since there is a global max-pooling operation near the end of the network, this finding suggests that the best model learns to primarily use features of locations that are repeatedly important throughout lower and higher levels of reasoning to make its final decision. The higher accuracies for models with FiLM modulating features inside residual connections rather than outside residual connections supports this hypothesis.\n\nModel Depth Table 3 shows model performance by the number of ResBlocks. FiLM is robust to varying depth but less so with only 1 ResBlock, backing the earlier theory that the FiLM-ed network reasons throughout its pipeline.\n\n# 4.4 CLEVR-Humans: Human-Posed Questions\n\nTo assess how well visual reasoning models generalize to more realistic, complex, and free-form questions, the CLEVR-Humans dataset was introduced (Johnson et al. 2017b). This dataset contains human-posed questions on CLEVR images along with their corresponding answers. The number of samples is limited — 18K for training, 7K\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-14/88b3b409-62e9-4654-98b2-6f9cd3da03d9/8a81f038d3240379cda0910f7ba69c65b5b1c41eb8df003b73cc2a4da9e61b19.jpg)  \nQ: What object is the color of grass? A: Cylinder\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-14/88b3b409-62e9-4654-98b2-6f9cd3da03d9/cec0ddc045a26f6ef723612a1f4ea3ad7808a4a6186394dada07150d9acfb414.jpg)  \nQ: Which shape objects are partially obscured from view? A: Sphere\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-14/88b3b409-62e9-4654-98b2-6f9cd3da03d9/3dbfad85f903044c8e7b05cc325658014d9934f6c974c8c978897bb9908152b9.jpg)  \nFigure 8: Examples from CLEVR-Humans, which introduces new words (underlined) and concepts. After fine-tuning on CLEVR-Humans, a CLEVR-trained model can now reason about obstruction, superlatives, and reflections but still struggles with hypothetical scenarios (rightmost). It also has learned human preference to primarily identify objects by shape (leftmost).\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-14/88b3b409-62e9-4654-98b2-6f9cd3da03d9/5d2c2ead7d1dc0d575e19e7eaf91455d22d5204af9143add57a5889cc15ceca0.jpg)  \nQ: What color is the matte object farthest to the right? A: Brown\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-14/88b3b409-62e9-4654-98b2-6f9cd3da03d9/a2963f290be1b0f311e1875cc6f136a09f9af3c502c60be8b8151de78a4183b2.jpg)  \nQ: What shape is reflecting in the large cube? A: Cylinder  \nQ: If all cubical objects were removed what shaped objects would there be the most of? A: Sphere (P: Rubber)\n\nfor validation, and 7K for testing. The questions were collected from Amazon Mechanical Turk workers prompted to ask questions that were likely hard for a smart robot to answer. As a result, CLEVR-Humans questions use more diverse vocabulary and complex concepts.\n\nMethod To test FiLM on CLEVR-Humans, we take our best CLEVR-trained FiLM model and fine-tune its FiLM-generating linguistic pipeline alone on CLEVR-Humans. Similar to prior work (Johnson et al. 2017b), we do not update the visual pipeline on CLEVR-Humans to mitigate overfitting to the small training set.\n\nResults Our model achieves state-of-the-art generalization to CLEVR-Humans, both before and after fine-tuning, as shown in Table 4, indicating that FiLM is well-suited to handle more complex and diverse questions. Figure 8 shows examples from CLEVR-Humans with FiLM model answers. Before fine-tuning, FiLM outperforms prior methods by a smaller margin. After fine-tuning, FiLM reaches a considerably improved final accuracy. In particular, the gain in accuracy made by FiLM upon fine-tuning is more than  $50\\%$  greater than those made by other models; FiLM adapts data-efficiently using the small CLEVR-Humans dataset.\n\nNotably, FiLM surpasses the prior state-of-the-art method, Program Generator + Execution Engine (PG+EE), after fine-tuning by  $9.3\\%$ . Prior work on PG+EEs explains that this neural module network method struggles on questions which cannot be well approximated with the model's module inventory (Johnson et al. 2017b). In contrast, FiLM has the freedom to modulate existing feature maps, a fairly flexible and fine-grained operation, in novel ways to reason about new concepts. These results thus provide some evidence for the benefits of FiLM's general nature.\n\n# 4.5 CLEVR Compositional Generalization Test\n\nTo test how well models learn compositional concepts that generalize, CLEVR-CoGenT was introduced (Johnson et al. 2017a). This dataset is synthesized in the same way as CLEVR but contains two conditions: in Condition A, all cubes are gray, blue, brown, or yellow and all cylinders are\n\n<table><tr><td>Model</td><td>Train CLEVR</td><td>Train CLEVR, fine-tune human</td></tr><tr><td>LSTM</td><td>27.5</td><td>36.5</td></tr><tr><td>CNN+LSTM</td><td>37.7</td><td>43.2</td></tr><tr><td>CNN+LSTM+SA+MLP</td><td>50.4</td><td>57.6</td></tr><tr><td>PG+EE (18K prog.)</td><td>54.0</td><td>66.6</td></tr><tr><td>CNN+GRU+FiLM</td><td>56.6</td><td>75.9</td></tr></table>\n\nTable 4: CLEVR-Humans test accuracy, before (left) and after (right) fine-tuning on CLEVR-Humans data\n\nred, green, purple, or cyan; in Condition B, cubes and cylinders swap color palettes. Both conditions contain spheres of all colors. CLEVR-CoGenT thus indicates how a model answers CLEVR questions: by memorizing combinations of traits or by learning disentangled or general representations.\n\nResults We train our best model architecture on Condition A and report accuracies on Conditions A and B, before and after fine-tuning on B, in Figure 9. Our results indicate FiLM surpasses other visual reasoning models at learning general concepts. FiLM learns better compositional generalization even than PG+EE, which explicitly models compositionality and is trained with program-level supervision that specifically includes filtering colors and filtering shapes.\n\nSample Efficiency and Catastrophic Forgetting We show sample efficiency and forgetting curves in Figure 9. FiLM achieves prior state-of-the-art accuracy with  $1/3$  as much fine-tuning data. However, our FiLM model still suffers from catastrophic forgetting after fine-tuning.\n\nZero-Shot Generalization FiLM's accuracy on Condition A is much higher than on B, suggesting FiLM has memorized attribute combinations to an extent. For example, the model learns a bias that cubes are not cyan, as learning this training set bias helps minimize training loss.\n\nTo overcome this bias, we develop a novel FiLM-based zero-shot generalization method. Inspired by word embedding manipulations, e.g. \"King\" - \"Man\" + \"Woman\" = \"Queen\" (Mikolov et al. 2013), we test if linear manipula\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-14/88b3b409-62e9-4654-98b2-6f9cd3da03d9/8b7d0106061c99c9d5f14e026c2fc5df8338a5d731c7efafb33b66ad1243f774.jpg)  \nFigure 10: A CLEVR-CoGenT example. The combination of concepts \"blue\" and \"cylinder\" is not in the training set. Our zero-shot method computes the original question's FiLM parameters via linear combination of three other questions' FiLM parameters:  $(1) + (2) - (3)$ . This method corrects our model's answer from \"rubber\" to \"metal\".\n\nNumber of unique samples (in thousands) used for training\n\n<table><tr><td rowspan=\"2\">Method</td><td colspan=\"2\">Train A</td><td colspan=\"2\">Fine-tune B</td></tr><tr><td>A</td><td>B</td><td>A</td><td>B</td></tr><tr><td>CNN+LSTM+SA</td><td>80.3</td><td>68.7</td><td>75.7</td><td>75.8</td></tr><tr><td>PG+EE (18K prog.)</td><td>96.6</td><td>73.7</td><td>76.1</td><td>92.7</td></tr><tr><td>CNN+GRU+FiLM</td><td>98.3</td><td>75.6</td><td>80.8</td><td>96.9</td></tr><tr><td>CNN+GRU+FiLM 0-Shot</td><td>98.3</td><td>78.8</td><td>81.1</td><td>96.9</td></tr></table>\n\ntion extends to reasoning with FiLM. We compute  $(\\gamma, \\beta)$  for \"How many cyan cubes are there?\" via the linear combination of questions in the FiLM parameter space: \"How many cyan spheres are there?\" + \"How many brown cubes are there?\" - \"How many brown spheres are there?\". With this  $(\\gamma, \\beta)$ , our model can correctly count cyan cubes. We show another example of this method in Figure 10.\n\nWe evaluate this method on validation B, using a parser to automatically generate the right combination of questions. We test previously reported CLEVR-CoGenT FiLM models with this method and show results in Figure 9. With this method, there is a  $3.2\\%$  overall accuracy gain when training on A and testing for zero-shot generalization on B. Yet this method could only be applied to  $1/3$  of questions in B. For these questions, model accuracy starts at  $71.5\\%$  and jumps to  $80.7\\%$ . Before fine-tuning on B, the accuracy between zero-shot and original approaches on A is identical, likewise for B after fine-tuning. We note that difference in the predicted FiLM parameters between these two methods is negligible, likely causing the similar performance.\n\nWe achieve these improvements without specifically training our model for zero-shot generalization. Our method simply allows FiLM to take advantage of any concept disentanglement in the CNN after training. We also observe that convex combinations of the FiLM parameters - i.e. between \"How many cyan things are there?\" and \"How many brown things are there?\" - often monotonically interpolates the predicted answer between the answers to endpoint questions. These results highlight, to a limited extent, the flexibility of FiLM parameters for meaningful manipulations.\n\nAs implemented, this method has many limitations. However, approaches from word embeddings, representation learning, and zero-shot learning can be applied to directly optimize  $(\\gamma, \\beta)$  for analogy-making (Bordes et al. 2013; Guu, Miller, and Liang 2015; Oh et al. 2017). The FiLM-ed network could directly train with this procedure via backpropagation. A learned model could also replace the parser. We find such avenues promising for future work.\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-14/88b3b409-62e9-4654-98b2-6f9cd3da03d9/903a5f65b098c9d6319d4ea5521a33387ea83204ba17969ad002dc084ecc6dc2.jpg)  \nFigure 9: CoGenT results. FiLM ValB accuracy reported on ValB without the 30K fine-tuning samples (Figure). Accuracy before and after fine-tuning on 30K of ValB (Table).\n\n<table><tr><td>Question</td><td>What is the blue big cylinder made of?</td></tr><tr><td>(1) Swap shape</td><td>What is the blue big sphere made of?</td></tr><tr><td>(2) Swap color</td><td>What is the green big cylinder made of?</td></tr><tr><td>(3) Swap shape/color</td><td>What is the green big sphere made of?</td></tr></table>\n",
  "hyperparameter": "Learning rate: 3e-4 (Adam optimizer); Weight decay: 1e-5; Batch size: 64; Number of ResBlocks: 4 (best performance, though 1-8 ResBlocks all achieve >93% accuracy); Hidden units in GRU: 4096; Word embedding dimension: 200; Feature maps per ResBlock: 128; Kernel size: 3×3 for convolutions, 4×4 for initial CNN layers; Image input size: 224×224; Classifier hidden units: 1024; Maximum training epochs: 80 with early stopping; Coordinate feature maps: scaled from -1 to 1"
}