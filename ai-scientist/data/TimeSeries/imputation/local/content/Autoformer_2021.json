{
  "id": "Autoformer_2021",
  "paper_title": "Autoformer: Decomposition Transformers with Auto-Correlation for Long-Term Series Forecasting",
  "alias": "Autoformer",
  "year": 2021,
  "domain": "TimeSeries",
  "task": "anomaly_detection",
  "idea": "Autoformer introduces a decomposition architecture with series decomposition blocks as inner operations to progressively extract trend-cyclical and seasonal components throughout the encoder-decoder structure. It proposes the Auto-Correlation mechanism that discovers period-based dependencies by computing series autocorrelation using FFT and aggregates similar sub-series through time delay aggregation, replacing point-wise self-attention with series-wise connections. This design achieves O(L log L) complexity while better handling intricate temporal patterns in long-term forecasting.",
  "introduction": "# 1 Introduction\n\nTime series forecasting has been widely used in energy consumption, traffic and economics planning, weather and disease propagation forecasting. In these real-world applications, one pressing demand is to extend the forecast time into the far future, which is quite meaningful for the long-term planning and early warning. Thus, in this paper, we study the long-term forecasting problem of time series, characterizing itself by the large length of predicted time series. Recent deep forecasting models [48, 23, 26, 34, 29, 35, 25, 41] have achieved great progress, especially the Transformer-based models. Benefiting from the self-attention mechanism, Transformers obtain great advantage in modeling long-term dependencies for sequential data, which enables more powerful big models [8, 13].\n\nHowever, the forecasting task is extremely challenging under the long-term setting. First, it is unreliable to discover the temporal dependencies directly from the long-term time series because the dependencies can be obscured by entangled temporal patterns. Second, canonical Transformers with self-attention mechanisms are computationally prohibitive for long-term forecasting because of the quadratic complexity of sequence length. Previous Transformer-based forecasting models [48, 23, 26] mainly focus on improving self-attention to a sparse version. While performance is significantly improved, these models still utilize the point-wise representation aggregation. Thus, in the process of efficiency improvement, they will sacrifice the information utilization because of the sparse point-wise connections, resulting in a bottleneck for long-term forecasting of time series.\n\nTo reason about the intricate temporal patterns, we try to take the idea of decomposition, which is a standard method in time series analysis [1, 33]. It can be used to process the complex time series and extract more predictable components. However, under the forecasting context, it can only be used as the pre-processing of past series because the future is unknown [20]. This common usage limits the capabilities of decomposition and overlooks the potential future interactions among decomposed components. Thus, we attempt to go beyond pre-processing usage of decomposition and propose a generic architecture to empower the deep forecasting models with immanent capacity of progressive decomposition. Further, decomposition can ravel out the entangled temporal patterns and highlight the inherent properties of time series [20]. Benefiting from this, we try to take advantage of the series periodicity to renovate the point-wise connection in self-attention. We observe that the sub-series at the same phase position among periods often present similar temporal processes. Thus, we try to construct a series-level connection based on the process similarity derived by series periodicity.\n\nBased on the above motivations, we propose an original Autoformer in place of the Transformers for long-term time series forecasting. Autoformer still follows residual and encoder-decoder structure but renovates Transformer into a decomposition forecasting architecture. By embedding our proposed decomposition blocks as the inner operators, Autoformer can progressively separate the long-term trend information from predicted hidden variables. This design allows our model to alternately decompose and refine the intermediate results during the forecasting procedure. Inspired by the stochastic process theory [9, 30], Autoformer introduces an Auto-Correlation mechanism in place of self-attention, which discovers the sub-series similarity based on the series periodicity and aggregates similar sub-series from underlying periods. This series-wise mechanism achieves  $\\mathcal{O}(L\\log L)$  complexity for length- $L$  series and breaks the information utilization bottleneck by expanding the point-wise representation aggregation to sub-series level. Autoformer achieves the state-of-the-art accuracy on six benchmarks. The contributions are summarized as follows:\n\n- To tackle the intricate temporal patterns of the long-term future, we present Autoformer as a decomposition architecture and design the inner decomposition block to empower the deep forecasting model with immanent progressive decomposition capacity.  \n- We propose an Auto-Correlation mechanism with dependencies discovery and information aggregation at the series level. Our mechanism is beyond previous self-attention family and can simultaneously benefit the computation efficiency and information utilization.  \n- Autoformer achieves a  $38\\%$  relative improvement under the long-term setting on six benchmarks, covering five real-world applications: energy, traffic, economics, weather and disease.",
  "method": "# 3 Autoformer\n\nThe time series forecasting problem is to predict the most probable length- $O$  series in the future given the past length- $I$  series, denoting as input- $I$ -predict- $O$ . The long-term forecasting setting is to predict the long-term future, i.e. larger  $O$ . As aforementioned, we have highlighted the difficulties of long-term series forecasting: handling intricate temporal patterns and breaking the bottleneck of computation efficiency and information utilization. To tackle these two challenges, we introduce the decomposition as a built-in block to the deep forecasting model and propose Autoformer as a decomposition architecture. Besides, we design the Auto-Correlation mechanism to discover the period-based dependencies and aggregate similar sub-series from underlying periods.\n\n# 3.1 Decomposition Architecture\n\nWe renovate Transformer [41] to a deep decomposition architecture (Figure 1), including the inner series decomposition block, Auto-Correlation mechanism, and corresponding Encoder and Decoder.\n\nSeries decomposition block To learn with the complex temporal patterns in long-term forecasting context, we take the idea of decomposition [1, 33], which can separate the series into trend-cyclical and seasonal parts. These two parts reflect the long-term progression and the seasonality of the series respectively. However, directly decomposing is unrealizable for future series because the future is just unknown. To tackle this dilemma, we present a series decomposition block as an inner operation of Autoformer (Figure 1), which can extract the long-term stationary trend from predicted intermediate hidden variables progressively. Concretely, we adapt the moving average to smooth out periodic fluctuations and highlight the long-term trends. For length- $L$  input series  $\\mathcal{X} \\in \\mathbb{R}^{L \\times d}$ , the process is:\n\n$$\n\\begin{array}{l} \\mathcal {X} _ {\\mathrm {t}} = \\operatorname {A v g P o o l} (\\text {P a d d i n g} (\\mathcal {X})) \\\\ \\mathcal {Y} = \\mathcal {Y} _ {1} \\mathcal {Y} _ {2} \\end{array} \\tag {1}\n$$\n\n$$\n\\mathcal {X} _ {\\mathrm {s}} = \\mathcal {X} - \\mathcal {X} _ {\\mathrm {t}},\n$$\n\nwhere  $\\mathcal{X}_{\\mathrm{s}},\\mathcal{X}_{\\mathrm{t}}\\in \\mathbb{R}^{L\\times d}$  denote the seasonal and the extracted trend-cyclical part respectively. We adopt the  $\\operatorname {AvgPool}(\\cdot)$  for moving average with the padding operation to keep the series length unchanged. We use  $\\mathcal{X}_{\\mathrm{s}},\\mathcal{X}_{\\mathrm{t}} = \\operatorname {SeriesDecomp}(\\mathcal{X})$  to summarize above equations, which is a model inner block.\n\nModel inputs The inputs of encoder part are the past  $I$  time steps  $\\mathcal{X}_{\\mathrm{en}} \\in \\mathbb{R}^{I \\times d}$ . As a decomposition architecture (Figure 1), the input of Autoformer decoder contains both the seasonal part  $\\mathcal{X}_{\\mathrm{des}} \\in \\mathbb{R}^{\\left(\\frac{I}{2} + O\\right) \\times d}$  and trend-cyclical part  $\\mathcal{X}_{\\mathrm{det}} \\in \\mathbb{R}^{\\left(\\frac{I}{2} + O\\right) \\times d}$  to be refined. Each initialization consists of two parts: the component decomposed from the latter half of encoder's input  $\\mathcal{X}_{\\mathrm{en}}$  with length  $\\frac{I}{2}$  to provide recent information, placeholders with length  $O$  filled by scalars. It's formulated as follows:\n\n$$\n\\mathcal {X} _ {\\mathrm {e n s}}, \\mathcal {X} _ {\\mathrm {e n t}} = \\operatorname {S e r i e s D e c o m p} \\left(\\mathcal {X} _ {\\mathrm {e n} \\frac {I}{2}: I}\\right)\n$$\n\n$$\n\\mathcal {X} _ {\\mathrm {d e s}} = \\operatorname {C o n c a t} \\left(\\mathcal {X} _ {\\mathrm {e n s}}, \\mathcal {X} _ {0}\\right) \\tag {2}\n$$\n\n$$\n\\mathcal {X} _ {\\mathrm {d e t}} = \\operatorname {C o n c a t} \\left(\\mathcal {X} _ {\\mathrm {e n t}}, \\mathcal {X} _ {\\mathrm {M e a n}}\\right),\n$$\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-13/8ceeef08-2da3-40b3-812c-a415d9c1a8c8/ac4d76fb6d8e032dabe438a98896c42050c5f02bdaac8c3a33cacf0b3a2e31ee.jpg)  \nFigure 1: Autoformer architecture. The encoder eliminates the long-term trend-cyclical part by series decomposition blocks (blue blocks) and focuses on seasonal patterns modeling. The decoder accumulates the trend part extracted from hidden variables progressively. The past seasonal information from encoder is utilized by the encoder-decoder Auto-Correlation (center green block in decoder).\n\nwhere  $\\mathcal{X}_{\\mathrm{ens}},\\mathcal{X}_{\\mathrm{ent}}\\in \\mathbb{R}^{\\frac{I}{2}\\times d}$  denote the seasonal and trend-cyclical parts of  $\\mathcal{X}_{\\mathrm{en}}$  respectively, and  $\\mathcal{X}_0,\\mathcal{X}_{\\mathrm{Mean}}\\in \\mathbb{R}^{O\\times d}$  denote the placeholders filled with zero and the mean of  $\\mathcal{X}_{\\mathrm{en}}$  respectively.\n\nEncoder As shown in Figure 1, the encoder focuses on the seasonal part modeling. The output of the encoder contains the past seasonal information and will be used as the cross information to help the decoder refine prediction results. Suppose we have  $N$  encoder layers. The overall equations for  $l$ -th encoder layer are summarized as  $\\mathcal{X}_{\\mathrm{en}}^{l} = \\mathrm{Encoder}(\\mathcal{X}_{\\mathrm{en}}^{l-1})$ . Details are shown as follows:\n\n$$\n\\mathcal {S} _ {\\mathrm {e n}, -} ^ {l, 1} = \\text {S e r i e s D e c o m p} \\left(\\text {A u t o - C o r r e l a t i o n} \\left(\\mathcal {X} _ {\\mathrm {e n}} ^ {l - 1}\\right) + \\mathcal {X} _ {\\mathrm {e n}} ^ {l - 1}\\right) \\tag {3}\n$$\n\n$$\n\\mathcal {S} _ {\\mathrm {e n}, -} ^ {l, 2} = \\operatorname {S e r i e s D e c o m p} \\left(\\operatorname {F e e d F o r w a r d} \\left(\\mathcal {S} _ {\\mathrm {e n}} ^ {l, 1}\\right) + \\mathcal {S} _ {\\mathrm {e n}} ^ {l, 1}\\right),\n$$\n\nwhere “_” is the eliminated trend part.  $\\mathcal{X}_{\\mathrm{en}}^{l} = S_{\\mathrm{en}}^{l,2}, l \\in \\{1, \\dots, N\\}$  denotes the output of  $l$ -th encoder layer and  $\\mathcal{X}_{\\mathrm{en}}^{0}$  is the embedded  $\\mathcal{X}_{\\mathrm{en}}$ .  $S_{\\mathrm{en}}^{l,i}, i \\in \\{1, 2\\}$  represents the seasonal component after the  $i$ -th series decomposition block in the  $l$ -th layer respectively. We will give detailed description of Auto-Correlation  $(\\cdot)$  in the next section, which can seamlessly replace the self-attention.\n\nDecoder The decoder contains two parts: the accumulation structure for trend-cyclical components and the stacked Auto-Correlation mechanism for seasonal components (Figure 1). Each decoder layer contains the inner Auto-Correlation and encoder-decoder Auto-Correlation, which can refine the prediction and utilize the past seasonal information respectively. Note that the model extracts the potential trend from the intermediate hidden variables during the decoder, allowing Autoformer to progressively refine the trend prediction and eliminate interference information for period-based dependencies discovery in Auto-Correlation. Suppose there are  $M$  decoder layers. With the latent variable  $\\mathcal{X}_{\\mathrm{en}}^{N}$  from the encoder, the equations of  $l$ -th decoder layer can be summarized as  $\\mathcal{X}_{\\mathrm{de}}^{l} = \\mathrm{Decoder}(\\mathcal{X}_{\\mathrm{de}}^{l-1}, \\mathcal{X}_{\\mathrm{en}}^{N})$ . The decoder can be formalized as follows:\n\n$$\n\\mathcal {S} _ {\\mathrm {d e}} ^ {l, 1}, \\mathcal {T} _ {\\mathrm {d e}} ^ {l, 1} = \\operatorname {S e r i e s D e c o m p} \\left(\\operatorname {A u t o - C o r r e l a t i o n} \\left(\\mathcal {X} _ {\\mathrm {d e}} ^ {l - 1}\\right) + \\mathcal {X} _ {\\mathrm {d e}} ^ {l - 1}\\right)\n$$\n\n$$\n\\mathcal {S} _ {\\mathrm {d e}} ^ {l, 2}, \\mathcal {T} _ {\\mathrm {d e}} ^ {l, 2} = \\operatorname {S e r i e s D e c o m p} \\left(\\operatorname {A u t o - C o r r e l a t i o n} \\left(\\mathcal {S} _ {\\mathrm {d e}} ^ {l, 1}, \\mathcal {X} _ {\\mathrm {e n}} ^ {N}\\right) + \\mathcal {S} _ {\\mathrm {d e}} ^ {l, 1}\\right) \\tag {4}\n$$\n\n$$\n\\mathcal {S} _ {\\mathrm {d e}} ^ {l, 3}, \\mathcal {T} _ {\\mathrm {d e}} ^ {l, 3} = \\operatorname {S e r i e s D e c o m p} \\left(\\operatorname {F e e d F o r w a r d} \\left(\\mathcal {S} _ {\\mathrm {d e}} ^ {l, 2}\\right) + \\mathcal {S} _ {\\mathrm {d e}} ^ {l, 2}\\right)\n$$\n\n$$\n\\mathcal {T} _ {\\mathrm {d e}} ^ {l} = \\mathcal {T} _ {\\mathrm {d e}} ^ {l - 1} + \\mathcal {W} _ {l, 1} * \\mathcal {T} _ {\\mathrm {d e}} ^ {l, 1} + \\mathcal {W} _ {l, 2} * \\mathcal {T} _ {\\mathrm {d e}} ^ {l, 2} + \\mathcal {W} _ {l, 3} * \\mathcal {T} _ {\\mathrm {d e}} ^ {l, 3},\n$$\n\nwhere  $\\mathcal{X}_{\\mathrm{de}}^{l} = S_{\\mathrm{de}}^{l,3}, l \\in \\{1, \\dots, M\\}$  denotes the output of  $l$ -th decoder layer.  $\\mathcal{X}_{\\mathrm{de}}^{0}$  is embedded from  $\\mathcal{X}_{\\mathrm{des}}$  for deep transform and  $\\mathcal{T}_{\\mathrm{de}}^{0} = \\mathcal{X}_{\\mathrm{det}}$  is for accumulation.  $\\mathcal{S}_{\\mathrm{de}}^{l,i}, \\mathcal{T}_{\\mathrm{de}}^{l,i}, i \\in \\{1,2,3\\}$  represent the seasonal component and trend-cyclical component after the  $i$ -th series decomposition block in the  $l$ -th layer respectively.  $\\mathcal{W}_{l,i}, i \\in \\{1,2,3\\}$  represents the projector for the  $i$ -th extracted trend  $\\mathcal{T}_{\\mathrm{de}}^{l,i}$ .\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-13/8ceeef08-2da3-40b3-812c-a415d9c1a8c8/57012a5f7bfa30cd046cf2ca342ff1e6e21c02ecab85f82627375d77bfa8cb1a.jpg)  \nFigure 2: Auto-Correlation (left) and Time Delay Aggregation (right). We utilize the Fast Fourier Transform to calculate the autocorrelation  $\\mathcal{R}(\\tau)$ , which reflects the time-delay similarities. Then the similar sub-processes are rolled to the same index based on selected delay  $\\tau$  and aggregated by  $\\mathcal{R}(\\tau)$ .\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-13/8ceeef08-2da3-40b3-812c-a415d9c1a8c8/96e03edb254b8c61cb31c8265108a943d567124c6e391b25d06fc7e2cb31baec.jpg)\n\nThe final prediction is the sum of the two refined decomposed components, as  $\\mathcal{W}_S * \\mathcal{X}_{\\mathrm{de}}^M + \\mathcal{T}_{\\mathrm{de}}^M$ , where  $\\mathcal{W}_S$  is to project the deep transformed seasonal component  $\\mathcal{X}_{\\mathrm{de}}^M$  to the target dimension.\n\n# 3.2 Auto-Correlation Mechanism\n\nAs shown in Figure 2, we propose the Auto-Correlation mechanism with series-wise connections to expand the information utilization. Auto-Correlation discovers the period-based dependencies by calculating the series autocorrelation and aggregates similar sub-series by time delay aggregation.\n\nPeriod-based dependencies It is observed that the same phase position among periods naturally provides similar sub-processes.\n\nInspired by the stochastic process theory [9, 30], for a real discrete-time process  $\\{\\mathcal{X}_t\\}$ , we can obtain the autocorrelation  $\\mathcal{R}_{\\mathcal{X},\\mathcal{X}}(\\tau)$  by the following equations:\n\n$$\n\\mathcal {R} _ {\\mathcal {X X}} (\\tau) = \\lim  _ {L \\rightarrow \\infty} \\frac {1}{L} \\sum_ {t = 1} ^ {L} \\mathcal {X} _ {t} \\mathcal {X} _ {t - \\tau}. \\tag {5}\n$$\n\n$\\mathcal{R}_{\\mathcal{X}\\mathcal{X}}(\\tau)$  reflects the time-delay similarity between  $\\{\\mathcal{X}_t\\}$  and its  $\\tau$  lag series  $\\{\\mathcal{X}_{t - \\tau}\\}$ . As shown in Figure 2, we use the autocorrelation  $\\mathcal{R}(\\tau)$  as the unnormalized confidence of estimated period length  $\\tau$ . Then, we choose the most possible  $k$  period lengths  $\\tau_{1},\\dots ,\\tau_{k}$ . The period-based dependencies are derived by the above estimated periods and can be weighted by the corresponding autocorrelation.\n\nTime delay aggregation The period-based dependencies connect the sub-series among estimated periods. Thus, we present the time delay aggregation block (Figure 2), which can roll the series based on selected time delay  $\\tau_{1},\\dots ,\\tau_{k}$ . This operation can align similar sub-series that are at the same phase position of estimated periods, which is different from the point-wise dot-product aggregation in self-attention family. Finally, we aggregate the sub-series by softmax normalized confidences.\n\nFor the single head situation and time series  $\\mathcal{X}$  with length-  $L$ , after the projector, we get query  $\\mathcal{Q}$ , key  $\\mathcal{K}$  and value  $\\nu$ . Thus, it can replace self-attention seamlessly. The Auto-Correlation mechanism is:\n\n$$\n\\tau_{1},\\dots ,\\tau_{k} = \\operatorname *{arg  Topk}_{\\tau \\in \\{1,\\dots ,L\\}}\\bigl(\\mathcal{R}_{\\mathcal{Q},\\mathcal{K}}(\\tau)\\bigr)\n$$\n\n$$\n\\widehat {\\mathcal {R}} _ {\\mathcal {Q}, \\mathcal {K}} \\left(\\tau_ {1}\\right), \\dots , \\widehat {\\mathcal {R}} _ {\\mathcal {Q}, \\mathcal {K}} \\left(\\tau_ {k}\\right) = \\operatorname {S o f t M a x} \\left(\\mathcal {R} _ {\\mathcal {Q}, \\mathcal {K}} \\left(\\tau_ {1}\\right), \\dots , \\mathcal {R} _ {\\mathcal {Q}, \\mathcal {K}} \\left(\\tau_ {k}\\right)\\right) \\tag {6}\n$$\n\n$$\n\\mathrm {A u t o - C o r r e l a t i o n} (\\mathcal {Q}, \\mathcal {K}, \\mathcal {V}) = \\sum_ {i = 1} ^ {k} \\mathrm {R o l l} (\\mathcal {V}, \\tau_ {i}) \\widehat {\\mathcal {R}} _ {\\mathcal {Q}, \\mathcal {K}} (\\tau_ {i}),\n$$\n\nwhere  $\\operatorname{argTopk}(\\cdot)$  is to get the arguments of the Topk autocorrelations and let  $k = \\lfloor c \\times \\log L \\rfloor$ ,  $c$  is a hyper-parameter.  $\\mathcal{R}_{\\mathcal{Q},\\mathcal{K}}$  is autocorrelation between series  $\\mathcal{Q}$  and  $\\mathcal{K}$ .  $\\mathrm{Roll}(\\mathcal{X},\\tau)$  represents the operation to  $\\mathcal{X}$  with time delay  $\\tau$ , during which elements that are shifted beyond the first position are re-introduced at the last position. For the encoder-decoder Auto-Correlation (Figure 1),  $\\mathcal{K},\\mathcal{V}$  are from the encoder  $\\mathcal{X}_{\\mathrm{en}}^{N}$  and will be resized to length- $O$ ,  $\\mathcal{Q}$  is from the previous block of the decoder.\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-13/8ceeef08-2da3-40b3-812c-a415d9c1a8c8/c253d26825499395f086f1d5d3c0c9876ab2153d9056f950878390cf80bf9b86.jpg)\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-13/8ceeef08-2da3-40b3-812c-a415d9c1a8c8/dc9f50d1d8acf2d81675c460b2c5bb473dbe95c050516bd6f3a53b7fd3767276.jpg)\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-13/8ceeef08-2da3-40b3-812c-a415d9c1a8c8/a4c4fc3e7986ee310979a03d028f908acaf577b81b2690399b33cdc88fb26da4.jpg)  \nFigure 3: Auto-Correlation vs. self-attention family. Full Attention [41] (a) adapts the fully connection among all time points. Sparse Attention [23, 48] (b) selects points based on the proposed similarity metrics. LogSparse Attention [26] (c) chooses points following the exponentially increasing intervals. Auto-Correlation (d) focuses on the connections of sub-series among underlying periods.\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-13/8ceeef08-2da3-40b3-812c-a415d9c1a8c8/326abd46b61b00b8a9de64b1b0d97670b9a4c58b923434b6664ceb02fbacad7c.jpg)\n\nFor the multi-head version used in Autoformer, with hidden variables of  $d_{\\mathrm{model}}$  channels,  $h$  heads, the query, key and value for  $i$ -th head are  $\\mathcal{Q}_i,\\mathcal{K}_i,\\mathcal{V}_i\\in \\mathbb{R}^{L\\times \\frac{d_{\\mathrm{model}}}{h}},i\\in \\{1,\\dots ,h\\}$ . The process is:\n\n$$\n\\begin{array}{l} \\operatorname {M u l t i H e a d} (\\mathcal {Q}, \\mathcal {K}, \\mathcal {V}) = \\mathcal {W} _ {\\text {o u t p u t}} * \\operatorname {C o n c a t} \\left(\\operatorname {h e a d} _ {1}, \\dots , \\operatorname {h e a d} _ {h}\\right) \\\\ \\text {h e r e h e a d} = \\operatorname {A n t e C o m p l a t i o n} (\\mathcal {Q}, \\mathcal {K}, \\mathcal {V}). \\end{array} \\tag {7}\n$$\n\n$$\nw h e r e \\operatorname {h e a d} _ {i} = \\operatorname {A u t o - C o r r e l a t i o n} \\left(\\mathcal {Q} _ {i}, \\mathcal {K} _ {i}, \\mathcal {V} _ {i}\\right).\n$$\n\nEfficient computation For period-based dependencies, these dependencies point to sub-processes at the same phase position of underlying periods and are inherently sparse. Here, we select the most possible delays to avoid picking the opposite phases. Because we aggregate  $\\mathcal{O}(\\log L)$  series whose length is  $L$ , the complexity of Equations 6 and 7 is  $\\mathcal{O}(L\\log L)$ . For the autocorrelation computation (Equation 5), given time series  $\\{\\mathcal{X}_t\\}$ ,  $\\mathcal{R}_{\\mathcal{X}\\mathcal{X}}(\\tau)$  can be calculated by Fast Fourier Transforms (FFT) based on the Wiener-Khinchin theorem [43]:\n\n$$\n\\mathcal {S} _ {\\mathcal {X X}} (f) = \\mathcal {F} \\left(\\mathcal {X} _ {t}\\right) \\mathcal {F} ^ {*} \\left(\\mathcal {X} _ {t}\\right) = \\int_ {- \\infty} ^ {\\infty} \\chi_ {t} e ^ {- i 2 \\pi t f} d t \\overline {{\\int_ {- \\infty} ^ {\\infty} \\chi_ {t} e ^ {- i 2 \\pi t f} d t}} \\tag {8}\n$$\n\n$$\n\\mathcal {R} _ {\\mathcal {X X}} (\\tau) = \\mathcal {F} ^ {- 1} \\left(\\mathcal {S} _ {\\mathcal {X X}} (f)\\right) = \\int_ {- \\infty} ^ {\\infty} \\mathcal {S} _ {\\mathcal {X X}} (f) e ^ {i 2 \\pi f \\tau} d f,\n$$\n\nwhere  $\\tau \\in \\{1, \\dots, L\\}$ ,  $\\mathcal{F}$  denotes the FFT and  $\\mathcal{F}^{-1}$  is its inverse. * denotes the conjugate operation and  $S_{\\mathcal{X}\\mathcal{X}}(f)$  is in the frequency domain. Note that the series autocorrelation of all lags in  $\\{1, \\dots, L\\}$  can be calculated at once by FFT. Thus, Auto-Correlation achieves the  $\\mathcal{O}(L\\log L)$  complexity.\n\nAuto-Correlation vs. self-attention family Different from the point-wise self-attention family, Auto-Correlation presents the series-wise connections (Figure 3). Concretely, for the temporal dependencies, we find the dependencies among sub-series based on the periodicity. In contrast, the self-attention family only calculates the relation between scattered points. Though some self-attention [26, 48] consider the local information, they only utilize this to help point-wise dependencies discovery. For the information aggregation, we adopt the time delay block to aggregate the similar sub-series from underlying periods. In contrast, self-attention aggregates the selected points by dot-product. Benefiting from the inherent sparsity and sub-series-level representation aggregation, Auto-Correlation can simultaneously benefit the computation efficiency and information utilization.",
  "experiments": "# 4 Experiments\n\nWe extensively evaluate the proposed Autoformer on six real-world benchmarks, covering five mainstream time series forecasting applications: energy, traffic, economics, weather and disease.\n\nDatasets Here is a description of the six experiment datasets: (1)  $ETT$  [48] dataset contains the data collected from electricity transformers, including load and oil temperature that are recorded every\n\nTable 1: Multivariate results with different prediction lengths  $O \\in \\{ {96},{192},{336},{720}\\}$  . We set the input length  $I$  as 36 for ILI and 96 for the others. A lower MSE or MAE indicates a better prediction.  \n\n<table><tr><td rowspan=\"2\" colspan=\"2\">ModelsMetric</td><td colspan=\"2\">Autoformern</td><td colspan=\"2\">Informer[48]</td><td colspan=\"2\">LogTrans[26]</td><td colspan=\"2\">Reformer[23]</td><td colspan=\"2\">LSTNet[25]</td><td colspan=\"2\">LSTM[17]</td><td colspan=\"2\">TCN[4]</td></tr><tr><td>MSE</td><td>MAE</td><td>MSE</td><td>MAE</td><td>MSE</td><td>MAE</td><td>MSE</td><td>MAE</td><td>MSE</td><td>MAE</td><td>MSE</td><td>MAE</td><td>MSE</td><td>MAE</td></tr><tr><td rowspan=\"4\">ETT*</td><td>96</td><td>0.255</td><td>0.339</td><td>0.365</td><td>0.453</td><td>0.768</td><td>0.642</td><td>0.658</td><td>0.619</td><td>3.142</td><td>1.365</td><td>2.041</td><td>1.073</td><td>3.041</td><td>1.330</td></tr><tr><td>192</td><td>0.281</td><td>0.340</td><td>0.533</td><td>0.563</td><td>0.989</td><td>0.757</td><td>1.078</td><td>0.827</td><td>3.154</td><td>1.369</td><td>2.249</td><td>1.112</td><td>3.072</td><td>1.339</td></tr><tr><td>336</td><td>0.339</td><td>0.372</td><td>1.363</td><td>0.887</td><td>1.334</td><td>0.872</td><td>1.549</td><td>0.972</td><td>3.160</td><td>1.369</td><td>2.568</td><td>1.238</td><td>3.105</td><td>1.348</td></tr><tr><td>720</td><td>0.422</td><td>0.419</td><td>3.379</td><td>1.388</td><td>3.048</td><td>1.328</td><td>2.631</td><td>1.242</td><td>3.171</td><td>1.368</td><td>2.720</td><td>1.287</td><td>3.135</td><td>1.354</td></tr><tr><td rowspan=\"4\">Electricity</td><td>96</td><td>0.201</td><td>0.317</td><td>0.274</td><td>0.368</td><td>0.258</td><td>0.357</td><td>0.312</td><td>0.402</td><td>0.680</td><td>0.645</td><td>0.375</td><td>0.437</td><td>0.985</td><td>0.813</td></tr><tr><td>192</td><td>0.222</td><td>0.334</td><td>0.296</td><td>0.386</td><td>0.266</td><td>0.368</td><td>0.348</td><td>0.433</td><td>0.725</td><td>0.676</td><td>0.442</td><td>0.473</td><td>0.996</td><td>0.821</td></tr><tr><td>336</td><td>0.231</td><td>0.338</td><td>0.300</td><td>0.394</td><td>0.280</td><td>0.380</td><td>0.350</td><td>0.433</td><td>0.828</td><td>0.727</td><td>0.439</td><td>0.473</td><td>1.000</td><td>0.824</td></tr><tr><td>720</td><td>0.254</td><td>0.361</td><td>0.373</td><td>0.439</td><td>0.283</td><td>0.376</td><td>0.340</td><td>0.420</td><td>0.957</td><td>0.811</td><td>0.980</td><td>0.814</td><td>1.438</td><td>0.784</td></tr><tr><td rowspan=\"4\">Exchange</td><td>96</td><td>0.197</td><td>0.323</td><td>0.847</td><td>0.752</td><td>0.968</td><td>0.812</td><td>1.065</td><td>0.829</td><td>1.551</td><td>1.058</td><td>1.453</td><td>1.049</td><td>3.004</td><td>1.432</td></tr><tr><td>192</td><td>0.300</td><td>0.369</td><td>1.204</td><td>0.895</td><td>1.040</td><td>0.851</td><td>1.188</td><td>0.906</td><td>1.477</td><td>1.028</td><td>1.846</td><td>1.179</td><td>3.048</td><td>1.444</td></tr><tr><td>336</td><td>0.509</td><td>0.524</td><td>1.672</td><td>1.036</td><td>1.659</td><td>1.081</td><td>1.357</td><td>0.976</td><td>1.507</td><td>1.031</td><td>2.136</td><td>1.231</td><td>3.113</td><td>1.459</td></tr><tr><td>720</td><td>1.447</td><td>0.941</td><td>2.478</td><td>1.310</td><td>1.941</td><td>1.127</td><td>1.510</td><td>1.016</td><td>2.285</td><td>1.243</td><td>2.984</td><td>1.427</td><td>3.150</td><td>1.458</td></tr><tr><td rowspan=\"4\">Traffic</td><td>96</td><td>0.613</td><td>0.388</td><td>0.719</td><td>0.391</td><td>0.684</td><td>0.384</td><td>0.732</td><td>0.423</td><td>1.107</td><td>0.685</td><td>0.843</td><td>0.453</td><td>1.438</td><td>0.784</td></tr><tr><td>192</td><td>0.616</td><td>0.382</td><td>0.696</td><td>0.379</td><td>0.685</td><td>0.390</td><td>0.733</td><td>0.420</td><td>1.157</td><td>0.706</td><td>0.847</td><td>0.453</td><td>1.463</td><td>0.794</td></tr><tr><td>336</td><td>0.622</td><td>0.337</td><td>0.777</td><td>0.420</td><td>0.733</td><td>0.408</td><td>0.742</td><td>0.420</td><td>1.216</td><td>0.730</td><td>0.853</td><td>0.455</td><td>1.479</td><td>0.799</td></tr><tr><td>720</td><td>0.660</td><td>0.408</td><td>0.864</td><td>0.472</td><td>0.717</td><td>0.396</td><td>0.755</td><td>0.423</td><td>1.481</td><td>0.805</td><td>1.500</td><td>0.805</td><td>1.499</td><td>0.804</td></tr><tr><td rowspan=\"4\">Weather</td><td>96</td><td>0.266</td><td>0.336</td><td>0.300</td><td>0.384</td><td>0.458</td><td>0.490</td><td>0.689</td><td>0.596</td><td>0.594</td><td>0.587</td><td>0.369</td><td>0.406</td><td>0.615</td><td>0.589</td></tr><tr><td>192</td><td>0.307</td><td>0.367</td><td>0.598</td><td>0.544</td><td>0.658</td><td>0.589</td><td>0.752</td><td>0.638</td><td>0.560</td><td>0.565</td><td>0.416</td><td>0.435</td><td>0.629</td><td>0.600</td></tr><tr><td>336</td><td>0.359</td><td>0.395</td><td>0.578</td><td>0.523</td><td>0.797</td><td>0.652</td><td>0.639</td><td>0.596</td><td>0.597</td><td>0.587</td><td>0.455</td><td>0.454</td><td>0.639</td><td>0.608</td></tr><tr><td>720</td><td>0.419</td><td>0.428</td><td>1.059</td><td>0.741</td><td>0.869</td><td>0.675</td><td>1.130</td><td>0.792</td><td>0.618</td><td>0.599</td><td>0.535</td><td>0.520</td><td>0.639</td><td>0.610</td></tr><tr><td rowspan=\"4\">ILI</td><td>24</td><td>3.483</td><td>1.287</td><td>5.764</td><td>1.677</td><td>4.480</td><td>1.444</td><td>4.400</td><td>1.382</td><td>6.026</td><td>1.770</td><td>5.914</td><td>1.734</td><td>6.624</td><td>1.830</td></tr><tr><td>36</td><td>3.103</td><td>1.148</td><td>4.755</td><td>1.467</td><td>4.799</td><td>1.467</td><td>4.783</td><td>1.448</td><td>5.340</td><td>1.668</td><td>6.631</td><td>1.845</td><td>6.858</td><td>1.879</td></tr><tr><td>48</td><td>2.669</td><td>1.085</td><td>4.763</td><td>1.469</td><td>4.800</td><td>1.468</td><td>4.832</td><td>1.465</td><td>6.080</td><td>1.787</td><td>6.736</td><td>1.857</td><td>6.968</td><td>1.892</td></tr><tr><td>60</td><td>2.770</td><td>1.125</td><td>5.264</td><td>1.564</td><td>5.278</td><td>1.560</td><td>4.882</td><td>1.483</td><td>5.548</td><td>1.720</td><td>6.870</td><td>1.879</td><td>7.127</td><td>1.918</td></tr></table>\n\n* ETT means the ETTm2. See Appendix A for the full benchmark of ETTh1, ETTh2, ETTm1.\n\n15 minutes between July 2016 and July 2018. (2) Electricity<sup>1</sup> dataset contains the hourly electricity consumption of 321 customers from 2012 to 2014. (3) Exchange [25] records the daily exchange rates of eight different countries ranging from 1990 to 2016. (4) Traffic<sup>2</sup> is a collection of hourly data from California Department of Transportation, which describes the road occupancy rates measured by different sensors on San Francisco Bay area freeways. (5) Weather<sup>3</sup> is recorded every 10 minutes for 2020 whole year, which contains 21 meteorological indicators, such as air temperature, humidity, etc. (6) ILI<sup>4</sup> includes the weekly recorded influenza-like illness (ILI) patients data from Centers for Disease Control and Prevention of the United States between 2002 and 2021, which describes the ratio of patients seen with ILI and the total number of the patients. We follow standard protocol and split all datasets into training, validation and test set in chronological order by the ratio of 6:2:2 for the ETT dataset and 7:1:2 for the other datasets.\n\nImplementation details Our method is trained with the L2 loss, using the ADAM [22] optimizer with an initial learning rate of  $10^{-4}$ . Batch size is set to 32. The training process is early stopped within 10 epochs. All experiments are repeated three times, implemented in PyTorch [31] and conducted on a single NVIDIA Titan RTX 24GB GPUs. The hyper-parameter  $c$  of Auto-Correlation is in the range of 1 to 3 to trade off performance and efficiency. See Appendix E and B for standard deviations and sensitivity analysis. Autoformer contains 2 encoder layers and 1 decoder layer.\n\nBaselines We include 10 baseline methods. For the multivariate setting, we select three latest state-of-the-art transformer-based models: Informer [48], Reformer [23], LogTrans [26], two RNN-based models: LSTM [25], LSTM [17] and CNN-based TCN [4] as baselines. For the univariate setting, we include more competitive baselines: N-BEATS[29], DeepAR [34], Prophet [39] and ARMIA [1].\n\nTable 2: Univariate results with different prediction lengths  $O \\in \\{96,192,336,720\\}$  on typical datasets. We set the input length  $I$  as 96. A lower MSE or MAE indicates a better prediction.  \n\n<table><tr><td colspan=\"2\">Models</td><td colspan=\"2\">Autoformer</td><td colspan=\"2\">N-BEATS[29]</td><td colspan=\"2\">Informer[48]</td><td colspan=\"2\">LogTrans[26]</td><td colspan=\"2\">Reformer[23]</td><td colspan=\"2\">DeepAR[34]</td><td colspan=\"2\">Prophet[39]</td><td colspan=\"2\">ARIMA[1]</td></tr><tr><td colspan=\"2\">Metric</td><td>MSE</td><td>MAE</td><td>MSE</td><td>MAE</td><td>MSE</td><td>MAE</td><td>MSE</td><td>MAE</td><td>MSE</td><td>MAE</td><td>MSE</td><td>MAE</td><td>MSE</td><td>MAE</td><td>MSE</td><td>MAE</td></tr><tr><td rowspan=\"4\">ETI</td><td>96</td><td>0.065</td><td>0.189</td><td>0.082</td><td>0.219</td><td>0.088</td><td>0.225</td><td>0.082</td><td>0.217</td><td>0.131</td><td>0.288</td><td>0.099</td><td>0.237</td><td>0.287</td><td>0.456</td><td>0.211</td><td>0.362</td></tr><tr><td>192</td><td>0.118</td><td>0.256</td><td>0.120</td><td>0.268</td><td>0.132</td><td>0.283</td><td>0.133</td><td>0.284</td><td>0.186</td><td>0.354</td><td>0.154</td><td>0.310</td><td>0.312</td><td>0.483</td><td>0.261</td><td>0.406</td></tr><tr><td>336</td><td>0.154</td><td>0.305</td><td>0.226</td><td>0.370</td><td>0.180</td><td>0.336</td><td>0.201</td><td>0.361</td><td>0.220</td><td>0.381</td><td>0.277</td><td>0.428</td><td>0.331</td><td>0.474</td><td>0.317</td><td>0.448</td></tr><tr><td>720</td><td>0.182</td><td>0.335</td><td>0.188</td><td>0.338</td><td>0.300</td><td>0.435</td><td>0.268</td><td>0.407</td><td>0.267</td><td>0.430</td><td>0.332</td><td>0.468</td><td>0.534</td><td>0.593</td><td>0.366</td><td>0.487</td></tr><tr><td rowspan=\"4\">Exchange</td><td>96</td><td>0.241</td><td>0.387</td><td>0.156</td><td>0.299</td><td>0.591</td><td>0.615</td><td>0.279</td><td>0.441</td><td>1.327</td><td>0.944</td><td>0.417</td><td>0.515</td><td>0.828</td><td>0.762</td><td>0.112</td><td>0.245</td></tr><tr><td>192</td><td>0.273</td><td>0.403</td><td>0.669</td><td>0.665</td><td>1.183</td><td>0.912</td><td>1.950</td><td>1.048</td><td>1.258</td><td>0.924</td><td>0.813</td><td>0.735</td><td>0.909</td><td>0.974</td><td>0.304</td><td>0.404</td></tr><tr><td>336</td><td>0.508</td><td>0.539</td><td>0.611</td><td>0.605</td><td>1.367</td><td>0.984</td><td>2.438</td><td>1.262</td><td>2.179</td><td>1.296</td><td>1.331</td><td>0.962</td><td>1.304</td><td>0.988</td><td>0.736</td><td>0.598</td></tr><tr><td>720</td><td>0.991</td><td>0.768</td><td>1.111</td><td>0.860</td><td>1.872</td><td>1.072</td><td>2.010</td><td>1.247</td><td>1.280</td><td>0.953</td><td>1.894</td><td>1.181</td><td>3.238</td><td>1.566</td><td>1.871</td><td>0.935</td></tr></table>\n\n# 4.1 Main Results\n\nTo compare performances under different future horizons, we fix the input length and evaluate models with a wide range of prediction lengths: 96, 192, 336, 720. This setting precisely meets the definition of long-term forecasting. Here are results on both the multivariate and univariate settings.\n\nMultivariate results As for the multivariate setting, Autoformer achieves the consistent state-of-the-art performance in all benchmarks and all prediction length settings (Table 10). Especially, under the input-96-predict-336 setting, compared to previous state-of-the-art results, Autoformer gives  $74\\%$ $(1.334\\rightarrow 0.339)$  MSE reduction in ETT,  $18\\%$ $(0.280\\rightarrow 0.231)$  in Electricity,  $61\\%$ $(1.357\\rightarrow 0.509)$  in Exchange,  $15\\%$ $(0.733\\rightarrow 0.622)$  in Traffic and  $21\\%$ $(0.455\\rightarrow 0.359)$  in Weather. For the input-36-predict-60 setting of ILI, Autoformer makes  $43\\%$ $(4.882\\rightarrow 2.770)$  MSE reduction. Overall, Autoformer yields a  $38\\%$  averaged MSE reduction among above settings. Note that Autoformer still provides remarkable improvements in the Exchange dataset that is without obvious periodicity. See Appendix E for detailed showcases. Besides, we can also find that the performance of Autoformer changes quite steadily as the prediction length  $O$  increases. It means that Autoformer retains better long-term robustness, which is meaningful for real-world practical applications, such as weather early warning and long-term energy consumption planning.\n\nUnivariate results We list the univariate results of two typical datasets in Table 2. Under the comparison with extensive baselines, our Autoformer still achieves state-of-the-art performance for the long-term forecasting tasks. In particular, for the input-96-predict-336 setting, our model achieves  $14\\%$ $(0.180\\rightarrow 0.145)$  MSE reduction on the ETT dataset with obvious periodicity. For the Exchange dataset without obvious periodicity, Autoformer surpasses other baselines by  $17\\%$ $(0.611\\rightarrow 0.508)$  and shows greater long-term forecasting capacity. Also, we find that ARIMA [1] performs best in the input-96-predict-96 setting of the Exchange dataset but fails in the long-term setting. This situation of ARIMA can be benefited from its inherent capacity for non-stationary economic data but is limited by the intricate temporal patterns of real-world series.\n\n# 4.2 Ablation studies\n\nTable 3: Ablation of decomposition in multivariate ETT with MSE metric. Ours adopts our progressive architecture into other models. Sep employs two models to forecast pre-decomposed seasonal and trend-cyclical components separately. Promotion is the MSE reduction compared to Origin.  \n\n<table><tr><td>Input-96</td><td colspan=\"3\">Transformer[41]</td><td colspan=\"3\">Informer[48]</td><td colspan=\"3\">LogTrans[23]</td><td colspan=\"3\">Reformer[26]</td><td colspan=\"2\">Promotion</td></tr><tr><td>Predict-O</td><td>Origin</td><td>Sep</td><td>Ours</td><td>Origin</td><td>Sep</td><td>Ours</td><td>Origin</td><td>Sep</td><td>Ours</td><td>Origin</td><td>Sep</td><td>Ours</td><td>Sep</td><td>Ours</td></tr><tr><td>96</td><td>0.604</td><td>0.311</td><td>0.204</td><td>0.365</td><td>0.490</td><td>0.354</td><td>0.768</td><td>0.862</td><td>0.231</td><td>0.658</td><td>0.445</td><td>0.218</td><td>0.069</td><td>0.347</td></tr><tr><td>192</td><td>1.060</td><td>0.760</td><td>0.266</td><td>0.533</td><td>0.658</td><td>0.432</td><td>0.989</td><td>0.533</td><td>0.378</td><td>1.078</td><td>0.510</td><td>0.336</td><td>0.300</td><td>0.562</td></tr><tr><td>336</td><td>1.413</td><td>0.665</td><td>0.375</td><td>1.363</td><td>1.469</td><td>0.481</td><td>1.334</td><td>0.762</td><td>0.362</td><td>1.549</td><td>1.028</td><td>0.366</td><td>0.434</td><td>1.019</td></tr><tr><td>720</td><td>2.672</td><td>3.200</td><td>0.537</td><td>3.379</td><td>2.766</td><td>0.822</td><td>3.048</td><td>2.601</td><td>0.539</td><td>2.631</td><td>2.845</td><td>0.502</td><td>0.079</td><td>2.332</td></tr></table>\n\nDecomposition architecture With our proposed progressive decomposition architecture, other models can gain consistent promotion, especially as the prediction length  $O$  increases (Table 3). This\n\nverifies that our method can generalize to other models and release the capacity of other dependencies learning mechanisms, alleviate the distraction caused by intricate patterns. Besides, our architecture outperforms the pre-processing, although the latter employs a bigger model and more parameters. Especially, pre-decomposing may even bring negative effect because it neglects the interaction of components during long-term future, such as Transformer [41] predict-720, Informer [48] predict-336.\n\nAuto-Correlation vs. self-attention family As shown in Table 4, our proposed Auto-Correlation achieves the best performance under various input-  $I$  -predict-  $O$  settings, which verifies the effectiveness of series-wise connections comparing to point-wise self-attention (Figure 3). Furthermore, we can also observe that Auto-Correlation is memory efficiency from the last column of Table 4, which can be used in long sequence forecasting, such as input-336-predict-1440.\n\nTable 4: Comparison of Auto-Correlation and self-attention in the multivariate ETT. We replace the Auto-Correlation in Autoformer with different self-attentions. The “-” indicates the out-of-memory.  \n\n<table><tr><td colspan=\"2\">Input Length I</td><td colspan=\"3\">96</td><td colspan=\"3\">192</td><td colspan=\"3\">336</td></tr><tr><td colspan=\"2\">Prediction Length O</td><td>336</td><td>720</td><td>1440</td><td>336</td><td>720</td><td>1440</td><td>336</td><td>720</td><td>1440</td></tr><tr><td rowspan=\"2\">Auto-Correlation</td><td>MSE</td><td>0.339</td><td>0.422</td><td>0.555</td><td>0.355</td><td>0.429</td><td>0.503</td><td>0.361</td><td>0.425</td><td>0.574</td></tr><tr><td>MAE</td><td>0.372</td><td>0.419</td><td>0.496</td><td>0.392</td><td>0.430</td><td>0.484</td><td>0.406</td><td>0.440</td><td>0.534</td></tr><tr><td rowspan=\"2\">Full Attention[41]</td><td>MSE</td><td>0.375</td><td>0.537</td><td>0.667</td><td>0.450</td><td>0.554</td><td>-</td><td>0.501</td><td>0.647</td><td>-</td></tr><tr><td>MAE</td><td>0.425</td><td>0.502</td><td>0.589</td><td>0.470</td><td>0.533</td><td>-</td><td>0.485</td><td>0.491</td><td>-</td></tr><tr><td rowspan=\"2\">LogSparse Attention[26]</td><td>MSE</td><td>0.362</td><td>0.539</td><td>0.582</td><td>0.420</td><td>0.552</td><td>0.958</td><td>0.474</td><td>0.601</td><td>-</td></tr><tr><td>MAE</td><td>0.413</td><td>0.522</td><td>0.529</td><td>0.450</td><td>0.513</td><td>0.736</td><td>0.474</td><td>0.524</td><td>-</td></tr><tr><td rowspan=\"2\">LSH Attention[23]</td><td>MSE</td><td>0.366</td><td>0.502</td><td>0.663</td><td>0.407</td><td>0.636</td><td>1.069</td><td>0.442</td><td>0.615</td><td>-</td></tr><tr><td>MAE</td><td>0.404</td><td>0.475</td><td>0.567</td><td>0.421</td><td>0.571</td><td>0.756</td><td>0.476</td><td>0.532</td><td>-</td></tr><tr><td rowspan=\"2\">ProbSparse Attention[48]</td><td>MSE</td><td>0.481</td><td>0.822</td><td>0.715</td><td>0.404</td><td>1.148</td><td>0.732</td><td>0.417</td><td>0.631</td><td>1.133</td></tr><tr><td>MAE</td><td>0.472</td><td>0.559</td><td>0.586</td><td>0.425</td><td>0.654</td><td>0.602</td><td>0.434</td><td>0.528</td><td>0.691</td></tr></table>\n\n# 4.3 Model Analysis\n\nTime series decomposition As shown in Figure 4, without our series decomposition block, the forecasting model cannot capture the increasing trend and peaks of the seasonal part. By adding the series decomposition blocks, Autoformer can aggregate and refine the trend-cyclical part from series progressively. This design also facilitates the learning of the seasonal part, especially the peaks and troughs. This verifies the necessity of our proposed progressive decomposition architecture.\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-13/8ceeef08-2da3-40b3-812c-a415d9c1a8c8/98644c1354e90e9094a8ed929b65af083fb7b780fcf76013c6b7da46f51e5012.jpg)  \n(a) Without decomposition block  \nFigure 4: Visualization of learned seasonal  $\\mathcal{X}_{\\mathrm{de}}^{M}$  and trend-cyclical  $\\mathcal{T}_{\\mathrm{de}}^{M}$  of the last decoder layer. We gradually add the decomposition blocks in decoder from left to right. This case is from ETT dataset under input-96-predict-720 setting. For clearness, we add the linear growth to raw data additionally.\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-13/8ceeef08-2da3-40b3-812c-a415d9c1a8c8/9f3f7eacae9e89d415116cf5ea0f324b9f59ed05f387c1dec563df679d7f910e.jpg)  \n(b) One decomposition block\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-13/8ceeef08-2da3-40b3-812c-a415d9c1a8c8/36352c0c9b4b5593ba2169d6464eff92ae597b5d4e2d5d6101936ad4f6383ac9.jpg)  \n(c) Two decomposition blocks\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-13/8ceeef08-2da3-40b3-812c-a415d9c1a8c8/e39296f5e9e4432efdf0179cc1cb7a5f95723f18cef2055da146e7d0c83779b0.jpg)  \n(d) Three decomposition blocks\n\nDependencies learning The marked time delay sizes in Figure 5(a) indicate the most likely periods. Our learned periodicity can guide the model to aggregate the sub-series from the same or neighbor phase of periods by  $\\mathrm{Roll}(\\mathcal{X},\\tau_i)$ ,  $i\\in \\{1,\\dots ,6\\}$ . For the last time step (declining stage), AutoCorrelation fully utilizes all similar sub-series without omissions or errors compared to self-attention. This verifies that Autoformer can discover the relevant information more sufficiently and precisely.\n\nComplex seasonality modeling As shown in Figure 6, the lags that Autoformer learns from deep representations can indicate the real seasonality of raw series. For example, the learned lags of the\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-13/8ceeef08-2da3-40b3-812c-a415d9c1a8c8/8075cb3b6560e96244b864f13cade2dc8f5c93888afd73c4dabc59065cd7a232.jpg)  \n(a) Auto-Correlation\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-13/8ceeef08-2da3-40b3-812c-a415d9c1a8c8/fbabc2526b4affd226fa91319739dcdbfdd01f284f43d8a5186102e23c251c2c.jpg)  \n(b) Full Attention\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-13/8ceeef08-2da3-40b3-812c-a415d9c1a8c8/19c2f0e9f5297ce1bdbed8f2c23b572dd566acde120f0f1456746cb337a523a7.jpg)  \n(c) LSH Attention\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-13/8ceeef08-2da3-40b3-812c-a415d9c1a8c8/8d18da9087490e894ad2feb91ea0487a72f65c46a090126d93b40585490ee615.jpg)  \n(d) ProbSparse Attention\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-13/8ceeef08-2da3-40b3-812c-a415d9c1a8c8/fc227f57cae734df9d4dd5d005741aa628b2b4691573036d9933eca5f4311d73.jpg)  \nFigure 5: Visualization of learned dependencies. For clearness, we select the top-6 time delay sizes  $\\tau_{1},\\dots ,\\tau_{6}$  of Auto-Correlation and mark them in raw series (red lines). For self-attention, top-6 similar points with respect to the last time step (red stars) are also marked by orange points.\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-13/8ceeef08-2da3-40b3-812c-a415d9c1a8c8/4eb3b5186bdce9102a3b6ea255df3521ae869fd169d2befd1fca84380b9d8428.jpg)  \n(a) Electricity (Hourly Recorded)  \n(b) Exchange (Daily Recorded)\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-13/8ceeef08-2da3-40b3-812c-a415d9c1a8c8/bd4a7e7be996639c338ea9e4d6789787d4907beb61b0377b2fdf696f6917649e.jpg)  \n(c) Traffic (Hourly Recorded)  \nFigure 6: Statistics of learned lags. For each time series in the test set, we count the top 10 lags learned by decoder for the input-96-predict-336 task. Figure (a)-(d) are the density histograms.\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-13/8ceeef08-2da3-40b3-812c-a415d9c1a8c8/987c70277f4507ce5dfc4bea4c8a7f3806fb0343f1313b0feb0e4a9a4cb76103.jpg)  \n(d) Weather (10min Recorded)\n\ndaily recorded Exchange dataset present the monthly, quarterly and yearly periods (Figure 6 (b)). For the hourly recorded Traffic dataset (Figure 6 (c)), the learned lags show the intervals as 24-hours and 168-hours, which match the daily and weekly periods of real-world scenarios. These results show that Autoformer can capture the complex seasonalities of real-world series from deep representations and further provide a human-interpretable prediction.\n\nEfficiency analysis We compare the running memory and time among Auto-Correlation-based and self-attention-based models (Figure 7) during the training phase. The proposed Autoformer shows  $\\mathcal{O}(L\\log L)$  complexity in both memory and time and achieves better long-term sequences efficiency.\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-13/8ceeef08-2da3-40b3-812c-a415d9c1a8c8/97979cf23a4c3a68da5e53991c04203c85994ee0d41d4903865cd636dd7031bb.jpg)  \n(a) Memory Efficiency Analysis  \nFigure 7: Efficiency Analysis. For memory, we replace Auto-Correlation with self-attention family in Autoformer and record the memory with input 96. For running time, we run the Auto-Correlation or self-attention  $10^{3}$  times to get the execution time per step. The output length increases exponentially.\n\n![](https://cdn-mineru.openxlab.org.cn/result/2025-12-13/8ceeef08-2da3-40b3-812c-a415d9c1a8c8/b8add171563f19a9f7c0b224e2a16a787f22e59774647728e6bf15d3ddf1b69c.jpg)  \n(b) Running Time Efficiency Analysis",
  "hyperparameter": "Training: ADAM optimizer with learning rate 10^-4, batch size 32, early stopping within 10 epochs, L2 loss. Architecture: 2 encoder layers, 1 decoder layer, input length I=96 (36 for ILI), prediction lengths O∈{96,192,336,720}. Auto-Correlation: k=⌊c×log L⌋ where c∈[1,3] for trading off performance and efficiency. Decoder initialization uses latter half of encoder input (length I/2) plus O placeholders filled with zeros (seasonal) or mean values (trend)."
}